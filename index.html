<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Audio meters by DrSnuggles</title>
  <script src="audiotools.js"></script> <!-- needed -->
  <script src="meter.js"></script>
  <script src="dnd.js"></script> <!-- drag n drop -->
  <link href="style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
  <!-- top menu -->
  <select id="testselect" onchange="play();">
    <optgroup label="Ellen L. Ripley">
      <option value="">WelcomeToOurStation.mp3</option>
      <option value="">WulleWulle.mp3</option>
      <option value="">WulleWulle_phase.mp3</option>
      <option value="">WulleWulle_mono.mp3</option>
      <option value="">WulleWulle_2mono.mp3</option>
      <option value="">WulleWulle_left.mp3</option>
      <option value="">WulleWulle_right.mp3</option>
    </optgroup>
    <optgroup label="Fraunhofer Stereo">
      <option value="https://www2.iis.fraunhofer.de/AAC">SBRtestStereoAot5Sig1.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">SBRtestStereoAot29Sig1.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">SBRtestStereoAot29Sig2.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">SBRtestStereoAot29Sig0.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">SBRtestStereoAot5SigusePS.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">SBRtestStereo-441-16b.wav</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">LFE-SBRstereo.mp4</option>
    </optgroup>
    <optgroup label="Fraunhofer xHE-AAC">
      <option value="https://www2.iis.fraunhofer.de/AAC">xHEchID.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">xHEchID.wav</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">xHErefLevel.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">xHErefLevel.wav</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">xheAvSync_v2.mp4</option>
    </optgroup>
    <optgroup label="Fraunhofer Multichannel">
      <option value="https://www2.iis.fraunhofer.de/AAC">ChID-BLITS-EBU-Narration.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">ChID-BLITS-EBU-Narration441-16b.wav</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">ChID-BLITS-EBU-Narration441AOT2.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">ChID-BLITS-EBU.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">SBR_LFEtest5_1.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">SBR_LFETest5_1-441-16b.wav</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">LFE-SBR.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">7.1auditionOutLeader_v2_rtb.mp4</option>
      <option value="https://www2.iis.fraunhofer.de/AAC">7.1auditionOutLeader v2.wav</option>
    </optgroup>
    <optgroup label="EBU Loudness Test Set v05">
      <option value="tests/EBU Loudness Test Set v05">1kHz Sine -20 LUFS-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">1kHz Sine -26 LUFS-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">1kHz Sine -40 LUFS-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">EBU-reference_listening_signal_pinknoise_500Hz_2kHz_R128.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-1-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-1-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-10-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-11-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-12-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-13-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-14-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-15-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-16-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-17-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-18-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-19-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-2-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-20-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-3-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-4-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-5-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-6-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-7-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-8-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-10-9-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-11-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-12-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-1-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-10-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-11-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-12-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-13-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-14-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-15-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-16-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-17-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-18-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-19-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-2-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-20-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-3-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-4-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-5-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-6-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-7-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-8-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-13-9-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-14-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-15-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-16-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-17-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-18-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-19-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-2-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-20-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-2011-8_seq-3342-6-24bit-v02.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-21-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-22-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-23-24bit.wav.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-3-16bit-v02.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-4-16bit-v02.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-5-16bit-v02.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-6-5channels-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-6-6channels-WAVEEX-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-7_seq-3342-5-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3341-9-24bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3342-1-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3342-2-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3342-3-16bit.wav</option>
      <option value="tests/EBU Loudness Test Set v05">seq-3342-4-16bit.wav</option>
    </optgroup>
    <optgroup label="Spoton">
      <option value="tests/Spoton">100Hz_16_44_AB_0.wav</option>
      <option value="tests/Spoton">100Hz_16_48_AB_0.wav</option>
      <option value="tests/Spoton">10kHz_16_44_AB_0.wav</option>
      <option value="tests/Spoton">10kHz_16_48_AB_0.wav</option>
      <option value="tests/Spoton">1kHz_16_11_AB_0.wav</option>
      <option value="tests/Spoton">1kHz_16_22_AB_0.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_0.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M10.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M12.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M18.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M2.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M20.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M24.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M4.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M6.wav</option>
      <option value="tests/Spoton">1kHz_16_44_AB_M8.wav</option>
      <option value="tests/Spoton">1kHz_16_44_A_0.wav</option>
      <option value="tests/Spoton">1kHz_16_44_B_0.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_0.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M10.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M12.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M14.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M16.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M18.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M2.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M20.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M21.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M24.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M4.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M6.wav</option>
      <option value="tests/Spoton">1kHz_16_48_AB_M8.wav</option>
      <option value="tests/Spoton">1kHz_16_8_AB_0.wav</option>
      <option value="tests/Spoton">1kHz_16_96_AB_0.wav</option>
      <option value="tests/Spoton">3kHz_16_44_AB_0.wav</option>
      <option value="tests/Spoton">3kHz_16_48_AB_0.wav</option>
      <option value="tests/Spoton">BLITS_16_48_M18FS.wav</option>
      <option value="tests/Spoton">BLITS_16_48_M8FS.wav</option>
      <option value="tests/Spoton">brown_noise.wav</option>
      <option value="tests/Spoton">ding_16_08_AB.wav</option>
      <option value="tests/Spoton">ding_16_11_AB.wav</option>
      <option value="tests/Spoton">ding_16_22_AB.wav</option>
      <option value="tests/Spoton">ding_16_44_AB.wav</option>
      <option value="tests/Spoton">ding_16_48_AB.wav</option>
      <option value="tests/Spoton">ding_16_96_AB.wav</option>
      <option value="tests/Spoton">DTMF0_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF1_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF2_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF3_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF4_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF5_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF6_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF7_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF8_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF9_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMFa_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMFb_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMFc_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMFd_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMFe_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMFf_48_A_M18.wav</option>
      <option value="tests/Spoton">DTMF_48_TestTones.wav</option>
      <option value="tests/Spoton">DTMF_48_TestToneSeq.wav</option>
      <option value="tests/Spoton">GLITS_16_44_0FS.wav</option>
      <option value="tests/Spoton">GLITS_16_44_M18FS.wav</option>
      <option value="tests/Spoton">GLITS_16_44_M20FS.wav</option>
      <option value="tests/Spoton">GLITS_16_44_M21FS.wav</option>
      <option value="tests/Spoton">GLITS_16_44_M24FS.wav</option>
      <option value="tests/Spoton">GLITS_16_48_0FS.wav</option>
      <option value="tests/Spoton">GLITS_16_48_M18FS.wav</option>
      <option value="tests/Spoton">GLITS_16_48_M20FS.wav</option>
      <option value="tests/Spoton">GLITS_16_48_M21FS.wav</option>
      <option value="tests/Spoton">GLITS_16_48_M24FS.wav</option>
      <option value="tests/Spoton">Ident_2Ch.wav</option>
      <option value="tests/Spoton">Ident_4Ch.wav</option>
      <option value="tests/Spoton">Ident_6Ch.wav</option>
      <option value="tests/Spoton">Ident_8Ch.wav</option>
      <option value="tests/Spoton">pink_noise.wav</option>
      <option value="tests/Spoton">Silence_16_44_AB_5s.wav</option>
      <option value="tests/Spoton">Silence_16_48_AB_10s.wav</option>
      <option value="tests/Spoton">Silence_16_48_AB_1s.wav</option>
      <option value="tests/Spoton">Silence_16_48_AB_20s.wav</option>
      <option value="tests/Spoton">Silence_16_48_AB_2s.wav</option>
      <option value="tests/Spoton">Silence_16_48_AB_5s.wav</option>
      <option value="tests/Spoton">white_noise.wav</option>
    </optgroup>
  </select>
  <button onclick="play()">Start</button>&nbsp;
  <button onclick="stop()">Stop</button>&nbsp;
  FFT: <select id="fftSize" onchange="change_fftSize(this.value);">
    <option value="32">32</option>
    <option value="64">64</option>
    <option value="128">128</option>
    <option value="256">256</option>
    <option value="512">512</option>
    <option value="1024">1024</option>
    <option value="2048" selected>2048</option>
    <option value="4096">4096</option>
    <option value="8192">8192</option>
    <option value="16384">16384</option>
    <option value="32768">32768</option>
  </select>&nbsp;
  Opacity <span id="actOpa">1.00</span>: <input type="range" min="0" max="1" value="1.00" step="0.01" onchange="change_opacity(this.value);"/>
  <span id="stat"></span>

  <!-- canvas for meters -->
  <canvas id="vectorCanvas"></canvas>
  <canvas id="corCanvas"></canvas>
  <canvas id="peakCanvas"></canvas>
  <canvas id="avgCanvas"></canvas>
  <canvas id="rmsCanvas"></canvas>
  <canvas id="waveform"></canvas> <!-- used in ATools if found -->

  <!-- start the show -->
  <script>
    var wave, analyzers, meter_gonio, meter_corr, meter_peak, meter_avg, meter_rms;
    init();

    function init() {
      // init meters
      meter_gonio = new meter('gon');
      meter_corr = new meter('cor');
      meter_peak = new meter('peak');
      meter_avg = new meter('avg');
      meter_rms = new meter('rms');

      // config meters
      meter_gonio.bgColor = [17, 17, 68, 0.25];// alpha < 1.0 -> CRT persistance
      meter_gonio.bgLines = ['L','R'];
      meter_gonio.bgLineColor = [170, 50, 170, 1.0];
      meter_gonio.color = [50, 200, 50, 1.0];

      meter_corr.bgColor = [17, 17, 68, 1.0];// alpha = 1.0 -> no CRT
      meter_corr.bgLines = ['M'];
      meter_corr.bgLineColor = [110, 255, 255, 1.0];
      meter_corr.color = [50, 200, 50, 1.0];

      meter_peak.bgColor = [17, 17, 68, 1.0]; // alpha = 1.0 -> no CRT
      meter_peak.bgLines = [];
      meter_peak.color = [255, 255, 180, 1.0];

      meter_avg.bgColor = [17, 68, 17, 1.0]; // alpha = 1.0 -> no CRT
      meter_avg.bgLines = [];
      meter_avg.color = [255, 255, 180, 1.0];

      meter_rms.bgColor = [68, 17, 17, 1.0]; // alpha = 1.0 -> no CRT
      meter_rms.bgLines = [];
      meter_rms.color = [255, 255, 180, 1.0];

      // start
      meter_gonio.start(vectorCanvas);
      meter_corr.start(corCanvas);
      meter_peak.start(peakCanvas);
      meter_avg.start(avgCanvas);
      meter_rms.start(rmsCanvas);

    } // init

    // change settings
    function change_opacity(newOpa) {
      // goniometer is only CRT style display
      meter_gonio.bgColor = [meter_gonio.bgColor[0], meter_gonio.bgColor[1], meter_gonio.bgColor[2], newOpa];
      actOpa.innerText = (newOpa*1).toFixed(2);
    }
    function change_fftSize(newSize) {
      ATools.setFFTsize(newSize);
    }
    function play() {
      var path = testselect.value;
      // remote sources are loaded via proxy
      if (path.indexOf("http") === 0) {
        path = "https://simpleproxy.drsnuggles.workers.dev?"+ path +"/";
      } else {
        path = "audio/"+ path +"/";
      }
      var url = path + testselect.options[testselect.selectedIndex].text;

      ATools.loadAudio( url );
    }
    function stop() {
      ATools.stopAudio();
    }

  </script>
</body>
</html>
